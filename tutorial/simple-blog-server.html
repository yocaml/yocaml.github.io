<!doctype html>
<html lang="en-US">
  <head>
    <title>YOCaml - A development server</title>
    <link rel="canonical" href="https://yocaml.github.io/tutorial/simple-blog-server.html" />
    <link rel="stylesheet" href="/assets/css/yocaml.css" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="YOCaml">
    <meta name="description" content="Setting up a small development server to facilitate page writing">
    <meta name="creator" content="grm">
    <meta name="creator" content="xvw">
    <meta property="og:site_name" content="YOCaml">
    <meta property="og:url" content="https://yocaml.github.io/tutorial/simple-blog-server.html">
    <meta property="og:title" content="A development server">
    <meta property="og:description" content="Setting up a small development server to facilitate page writing">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2025-09-08T00:00:00Z">
    <meta property="article:modified_time" content="2025-09-08T00:00:00Z">
    <meta property="article:section" content="Tutorial">
    </head>
  <body>
    <header>
      <div>
        <h1>YOCaml</h1>
      </div>
    </header>
    <main>
      <div>
        <div class="article-container">
  <div class="article-with-side-bar">
    
    <aside class="sidebar yo--navigation">
      
      <nav>
        <h4>Preamble</h4>
        
        
        <a href="/tutorial/index.html"
           title="A conceptual introduction to YOCaml"
           class="">
          Introduction
        </a>
        
        
        <a href="/tutorial/why.html"
           title="The promotional part of YOCaml"
           class="">
          Why use YOCaml
        </a>
        
        
        <a href="/tutorial/setup.html"
           title="Mise en place d&apos;un environnement de développement"
           class="">
          Installation and setup
        </a>
        
        
        <a href="/tutorial/key-concepts.html"
           title="Explanation of key points and concepts for building with YOCaml"
           class="">
          Key concepts
        </a>
        </nav>
      
      <nav>
        <h4>Your first blog</h4>
        
        
        <a href="/tutorial/simple-blog-goal.html"
           title="The goal and the introduction of the tutorial"
           class="">
          Goals &amp; Introduction
        </a>
        
        
        <a href="/tutorial/simple-blog-images.html"
           title="A First Action: Moving Images to the Target"
           class="">
          Moving images
        </a>
        
        
        <a href="/tutorial/simple-blog-css.html"
           title="A New Action: Generating CSS file"
           class="">
          Generating CSS
        </a>
        
        
        <a href="/tutorial/simple-blog-pages.html"
           title="Creating the first pages: written in Markdown, converted to HTML, and injected into templates"
           class="">
          Our first pages
        </a>
        
        
        <span class="">
          A development server
        </span>
        
        
        <a href="/tutorial/simple-blog-articles.html"
           title="Creation of pages dedicated to articles"
           class="">
          Article creation
        </a>
        
        
        <a href="/tutorial/simple-blog-index.html"
           title="Creation of an index"
           class="">
          Article indexation
        </a>
        
        
        <a href="/tutorial/simple-blog-feed.html"
           title="Creating an ATOM syndication feed"
           class="">
          Creating a syndication feed
        </a>
        
        
        <a href="/tutorial/simple-blog-final.html"
           title="Conclusion on the entire tutorial"
           class="">
          Final words
        </a>
        </nav>
      
      <nav>
        <h4>Specifics</h4>
        
        
        <a href="/tutorial/path.html"
           title="TBD"
           class="to-be-done">
          Path manipulation
        </a>
        
        
        <a href="/tutorial/validation.html"
           title="TBD"
           class="to-be-done">
          Data validation and Metadata
        </a>
        
        
        <a href="/tutorial/task.html"
           title="TBD"
           class="to-be-done">
          Building and composing Task
        </a>
        </nav>
      
    </aside>
    
    <section>
      <h1 class="main-title">A development server</h1>



<section class="prose">
<p>Now that we have some pages, let’s see how to set up a small development server to preview our generated site in action!</p>

</section>

<article class="prose">
<div class="hidden-toplevel">
<pre><code><span class='ocaml-keyword-other'>#</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other'>#</span><span class='ocaml-source'>install_printer</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Yocaml</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-constant-language-capital-identifier'>Path</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>pp</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-source'>
</span><span class='ocaml-keyword-other'>#</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other'>#</span><span class='ocaml-source'>install_printer</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Yocaml</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-constant-language-capital-identifier'>Deps</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>pp</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-source'>
</span></code></pre>
<pre><code><span class='ocaml-keyword-other'>open</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Yocaml</span><span class='ocaml-source'>
</span><span class='ocaml-keyword'>let</span><span class='ocaml-source'> </span><span class='ocaml-entity-name-function-binding'>www</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>=</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Path</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>rel</span><span class='ocaml-source'> </span><span class='ocaml-source'>[</span><span class='ocaml-source'> </span><span class='ocaml-string-quoted-double'>&quot;</span><span class='ocaml-string-quoted-double'>_www</span><span class='ocaml-string-quoted-double'>&quot;</span><span class='ocaml-source'> </span><span class='ocaml-source'>]</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-source'>
</span></code></pre>
</div>
<p>Up to now, we’ve been using <code>cat</code> each time to check that our
generator was working properly. That wasn’t a very efficient
approach—especially if we want to fine-tune our <em>layout</em>. Being able
to view the site in a real environment is a huge advantage! You might
think that since our generator produces HTML pages (among other
things), we could simply open them directly in a web
browser. Unfortunately, that doesn’t really work. When creating our
templates, we assumed that the site would always be served from the
root of a server—but chances are you’re not generating your site at
the root of your computer’s filesystem, right?</p>
<p>To address this, the runtimes (<code>Yocaml_unix</code> and <code>Yocaml_eio</code>) come
with a function similar to <code>run</code>, whose purpose is to start a small
local server that serves our files:</p>
<h2 id="starting-the-server"><a class="anchor" aria-hidden="true" href="#starting-the-server"></a>Starting the Server</h2>
<p>The function is very similar to its counterpart, <code>run</code>. Let’s take a
quick look at its specification:</p>
<pre><code><span class='ocaml-keyword-other'>#</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Yocaml_unix</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>serve</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-keyword-other-ocaml punctuation-separator-terminator punctuation-separator'>;</span><span class='ocaml-source'>
</span><span class='ocaml-keyword-operator'>-</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-source'> ?</span><span class='ocaml-source'>level</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-constant-language-capital-identifier'>Yocaml_runtime</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-constant-language-capital-identifier'>Log</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>level</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'>
</span><span class='ocaml-source'>    ?</span><span class='ocaml-source'>custom_error_handler</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-source'>(</span><span class='ocaml-constant-language-capital-identifier'>Format</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>formatter</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'>
</span><span class='ocaml-source'>                           </span><span class='ocaml-constant-language-capital-identifier'>Yocaml</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-constant-language-capital-identifier'>Data</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-constant-language-capital-identifier'>Validation</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>custom_error</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> </span><span class='ocaml-support-type'>unit</span><span class='ocaml-source'>)</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'>
</span><span class='ocaml-source'>    </span><span class='ocaml-source'>target</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-constant-language-capital-identifier'>Path</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>t</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> </span><span class='ocaml-source'>port</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-support-type'>int</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> </span><span class='ocaml-source'>(</span><span class='ocaml-support-type'>unit</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> </span><span class='ocaml-support-type'>unit</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Eff</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>t</span><span class='ocaml-source'>)</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> </span><span class='ocaml-support-type'>unit</span><span class='ocaml-source'>
</span><span class='ocaml-keyword-operator'>=</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>&lt;</span><span class='ocaml-keyword-other'>fun</span><span class='ocaml-keyword-operator'>&gt;</span><span class='ocaml-source'>
</span></code></pre>
<p>The function is very similar. Just like <code>run</code>, it also takes a log
level, and the function <code>(unit -&gt; unit Yocaml.Eff.t)</code> is the same as
the one accepted by <code>run</code>. In fact, the only differences are in
<code>target</code> and <code>port</code>.</p>
<ul>
<li>
<p><code>target</code> is the directory that will serve as the root of our
server. Here, we’ll set it to the <code>_www</code> directory.</p>
</li>
<li>
<p><code>port</code> is the port our server will listen on. For this example,
we’ll use <code>8000</code>.</p>
</li>
</ul>
<h3 id="serving-our-site"><a class="anchor" aria-hidden="true" href="#serving-our-site"></a>Serving our Site</h3>
<p>In practice, we can simply adjust how we run our generator like this:</p>
<pre><code><span class='diff-source'>let () = 
</span><span class='diff-punctuation-definition-deleted'>-</span><span class='diff-markup-deleted'>  Yocaml_unix.run ~level:`Debug program
</span><span class='diff-punctuation-definition-inserted'>+</span><span class='diff-markup-inserted'>  Yocaml_unix.serve 
</span><span class='diff-punctuation-definition-inserted'>+</span><span class='diff-markup-inserted'>       ~level:`Info 
</span><span class='diff-punctuation-definition-inserted'>+</span><span class='diff-markup-inserted'>       ~target:www ~port:8000 
</span><span class='diff-punctuation-definition-inserted'>+</span><span class='diff-markup-inserted'>       program
</span></code></pre>
<p>If you run your generator (<code>dune exec bin/blog.exe</code>), you should see
the following message appear in your terminal:</p>
<pre><code><span class='shell-source'>[INFO]Launching server </span><span class='shell-keyword-operator-redirect'>&lt;</span><span class='shell-source'>http://localhost:</span><span class='shell-keyword-operator-redirect'>8000&gt;</span><span class='shell-source'>
</span></code></pre>
<p>And by visiting <a href="http://localhost:8000">localhost:8000</a>, you should be
able to see your website! <em>Excellent</em>.</p>
<h4 id="server-features"><a class="anchor" aria-hidden="true" href="#server-features"></a>Server Features</h4>
<p>The server is <strong>essentially a development server</strong>—it is <strong>not
intended for production use</strong>. In fact, every time the server receives
a request, it <strong>re-runs the program</strong>.</p>
<blockquote>
<p>The fact that the program is re-executed on <strong>every</strong> page refresh
might sound alarming. However, remember that YOCaml strives for
minimalism: if nothing has changed, refreshing a page will result in
no modifications at all.</p>
</blockquote>
<p>Additionally, the server provides a minimal browser view (if the
directory does not contain an <code>index.html</code> page) and allows serving a
<code>/404.html</code> page as a substitute for 404 errors.</p>
<h2 id="conditional-execution"><a class="anchor" aria-hidden="true" href="#conditional-execution"></a>Conditional Execution</h2>
<p>Our initial approach is a bit crude. Ideally, we want to control via
CLI arguments whether we want to build our site (for example, to be
invoked from CI) or serve it during the drafting process.</p>
<p>We can use a very simple approach, which is sufficient for the
purposes of this tutorial:</p>
<!-- $MDX skip -->
<pre><code><span class='ocaml-source'>
</span><span class='ocaml-keyword-other'>let</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-unit'>()</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>=</span><span class='ocaml-source'>
</span><span class='ocaml-source'>  </span><span class='ocaml-keyword-other'>match</span><span class='ocaml-source'> </span><span class='ocaml-constant-language-capital-identifier'>Sys</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>argv</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>(</span><span class='ocaml-constant-numeric-decimal-integer'>1</span><span class='ocaml-source'>)</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other'>with</span><span class='ocaml-source'>
</span><span class='ocaml-source'>  </span><span class='ocaml-keyword-other'>|</span><span class='ocaml-source'> </span><span class='ocaml-string-quoted-double'>&quot;</span><span class='ocaml-string-quoted-double'>server</span><span class='ocaml-string-quoted-double'>&quot;</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>    </span><span class='ocaml-constant-language-capital-identifier'>Yocaml_unix</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>serve</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       ~</span><span class='ocaml-source'>level</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-constant-language-polymorphic-variant'>`Info</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       ~</span><span class='ocaml-source'>target</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-source'>www</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       ~</span><span class='ocaml-source'>port</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-constant-numeric-decimal-integer'>8000</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       </span><span class='ocaml-source'>program</span><span class='ocaml-source'>
</span><span class='ocaml-source'>  </span><span class='ocaml-keyword-other'>|</span><span class='ocaml-source'> </span><span class='ocaml-constant-language'>_</span><span class='ocaml-source'> </span><span class='ocaml-keyword-other'>|</span><span class='ocaml-source'> </span><span class='ocaml-source'>(</span><span class='ocaml-keyword-other'>exception</span><span class='ocaml-source'> </span><span class='ocaml-constant-language'>_</span><span class='ocaml-source'>)</span><span class='ocaml-source'> </span><span class='ocaml-keyword-operator'>-&gt;</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>     </span><span class='ocaml-constant-language-capital-identifier'>Yocaml_unix</span><span class='ocaml-keyword-other-ocaml punctuation-other-period punctuation-separator'>.</span><span class='ocaml-source'>run</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       ~</span><span class='ocaml-source'>level</span><span class='ocaml-keyword-other-ocaml punctuation-other-colon punctuation'>:</span><span class='ocaml-constant-language-polymorphic-variant'>`Debug</span><span class='ocaml-source'> 
</span><span class='ocaml-source'>       </span><span class='ocaml-source'>program</span><span class='ocaml-source'>
</span><span class='ocaml-source'>
</span></code></pre>
<p>Of course, it’s possible to drastically improve our CLI by using tools
like <a href="https://github.com/dbuenzli/cmdliner">Cmdliner</a> to, for
instance, make the <code>port</code> configurable. (You can find resources for
<a href="https://ocaml.org/docs/cli-arguments">command-line parsing</a> on the
official site.)</p>
<h2 id="conclusion"><a class="anchor" aria-hidden="true" href="#conclusion"></a>Conclusion</h2>
<p>We’ve seen how to support a small development server, which is very
useful during the drafting or <em>design</em> process. It has been designed
to be easy to use and flexible enough to cover a wide range of
scenarios.</p>

</article>




      
      <div class="prev-next">
        
        <a href="/tutorial/simple-blog-pages.html"
           title="Creating the first pages: written in Markdown, converted to HTML, and injected into templates"
           class="previous">
          <h4>Previous</h4>
          <span class="section-title">Your first blog</span>
          <span>Our first pages</span>
        </a>
        
        
        <a href="/tutorial/simple-blog-articles.html"
           title="Creation of pages dedicated to articles"
           class="next">
          <h4>Next</h4>
          <span class="section-title">Your first blog</span>
          <span>Article creation</span>
        </a>
        
      </div>
      
    </section>
    <aside class="toc yo--navigation">
      
      <nav id="active-toc">
        <h4>Table of content</h4>
        <ul><li><a href="#starting-the-server" data-toc-target="starting-the-server">Starting the Server</a><ul><li><a href="#serving-our-site" data-toc-target="serving-our-site">Serving our Site</a><ul><li><a href="#server-features" data-toc-target="server-features">Server Features</a></li></ul></li></ul></li><li><a href="#conditional-execution" data-toc-target="conditional-execution">Conditional Execution</a></li><li><a href="#conclusion" data-toc-target="conclusion">Conclusion</a></li></ul>
      </nav>
      
    </aside>
  </div>
</div>


      </div>
    </main>
    <footer>
      <div>
        <div class="yo--grid-col-autofill yo--navigation modules">
          <nav>
            <h4>Navigation</h4>
            <a href="/">Home</a>
            <a href="/tutorial">Tutorial</a>
            <a href="https://github.com/xhtmlboi/yocaml">
              YOCaml repository
            </a>
            <a href="https://github.com/yocaml/yocaml-www">
              Site repository
            </a>
            <a href="https://yocaml.github.io/doc">API Doc</a>
          </nav>
          <nav>
            <h4>Bug Trackers</h4>
            <a href="https://github.com/xhtmlboi/yocaml/issues">
              YOCaml
            </a>
            <a href="https://github.com/yocaml/yocaml-www/issues">
              Site
            </a>
            
            <a href="https://github.com/yocaml/yocaml-www/blob/main/content/tutorial/simple-blog-server.md">
              Page source
            </a>
            
          </nav>
          
          <nav class="inline">
            <h4>Latest releases</h4>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.5.0">
              v2.5.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.4.1">
              v2.4.1
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.4.0">
              v2.4.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.3.0">
              v2.3.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.2.0">
              v2.3.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.1.0">
              v2.1.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.0.1">
              v2.0.1
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.0.0">
              v2.0.0
            </a>
            
            <a href="https://github.com/xhtmlboi/yocaml/releases/tag/v1.0.0">
              v1.0.0
            </a>
            
          </nav>
          
        </div>
      </div>
      <div class="yo--grid-col-autofill bottom-line">
        <div>
          <div>
            <a href="https://ocaml.org" title="OCaml website">
              <svg role="img" class="yo--icon">
                <use href="/assets/images/icons.svg#ocaml" />
              </svg>
            </a>  
          </div>
          <div>
            Proudly generated by
            <a href="https://github.com/xhtmlboi/yocaml">
              YOCaml
            </a>
          </div>
        </div>
        <div>
          <div>
            Generator under
            <a href="https://gnu.org/licenses/gpl-3.0.html">
              GPL 3.0
            </a>
            <br/>
            Content under
            <a href="https://creativecommons.org/licenses/by-sa/4.0/">
              CC BY-SA
            </a>
          </div>
          <div>
            <a href="https://creativecommons.org/licenses/by-sa/4.0/">
              <svg role="img" class="yo--icon">
                <use href="/assets/images/icons.svg#cc" />
              </svg>
            </a>
          </div>
      </div>
    </footer>
    <script src="/assets/js/frontend.bc.js"></script>
  </body>
</html>
